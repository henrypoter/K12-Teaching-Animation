<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§å­èŒå‘å…¨æ—¶ç¨‹äº¤äº’æ•™å­¦åŠ¨ç”» (0-15å¤©)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #8B4513;
        }

        h1 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
        }

        .animation-section {
            flex: 3;
            min-width: 300px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .control-section {
            flex: 2;
            min-width: 280px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .section-title {
            color: #8B4513;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
            font-size: 1.3em;
        }

        /* ç”»å¸ƒå®¹å™¨ */
        #animationCanvas {
            background-color: #fafafa;
            border-radius: 8px;
            border: 1px solid #ddd;
            width: 100%;
            height: 400px;
            cursor: pointer;
            margin-bottom: 15px;
        }

        /* è§†å›¾åˆ‡æ¢æŒ‰é’® */
        .view-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .view-btn {
            flex: 1;
            padding: 10px;
            background-color: #e8f5e9;
            border: 2px solid #a5d6a7;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            color: #2e7d32;
            transition: all 0.3s;
        }

        .view-btn:hover {
            background-color: #c8e6c9;
        }

        .view-btn.active {
            background-color: #4caf50;
            color: white;
            border-color: #388e3c;
        }

        /* æ—¶é—´è½´ */
        .timeline-container {
            margin-top: 10px;
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        #currentDay {
            font-weight: bold;
            color: #8B4513;
        }

        #timelineSlider {
            width: 100%;
            height: 30px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #D2B48C, #8B4513);
            border-radius: 15px;
            outline: none;
        }

        #timelineSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #1E90FF;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }

        .timeline-marks {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.85em;
            color: #666;
        }

        .timeline-mark {
            text-align: center;
            width: 40px;
        }

        .timeline-mark.highlight {
            color: #FF8C00;
            font-weight: bold;
        }

        /* æ’­æ”¾æ§åˆ¶ */
        .playback-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .playback-btn {
            flex: 1;
            padding: 10px;
            background-color: #e3f2fd;
            border: 2px solid #90caf9;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            color: #1565c0;
            transition: all 0.3s;
        }

        .playback-btn:hover {
            background-color: #bbdefb;
        }

        #playPauseBtn {
            flex: 2;
        }

        /* æ¡ä»¶æ§åˆ¶ */
        .condition-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .condition-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 5px solid;
            transition: all 0.3s;
        }

        .condition-item.water {
            border-left-color: #87CEEB;
        }

        .condition-item.air {
            border-left-color: #D3D3D3;
        }

        .condition-item.temp {
            border-left-color: #FFA500;
        }

        .condition-icon {
            font-size: 1.8em;
            width: 40px;
            text-align: center;
        }

        .condition-info {
            flex: 1;
        }

        .condition-name {
            font-weight: 600;
            margin-bottom: 3px;
        }

        .condition-desc {
            font-size: 0.9em;
            color: #666;
        }

        /* å¼€å…³æ ·å¼ */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4caf50;
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        /* ä¿¡æ¯é¢æ¿ */
        .info-panel {
            background-color: #f0f7ff;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #bbdefb;
            min-height: 120px;
        }

        .info-title {
            color: #1E90FF;
            margin-bottom: 10px;
            font-weight: 600;
        }

        #infoText {
            font-size: 0.95em;
            line-height: 1.5;
        }

        .hint {
            font-size: 0.9em;
            color: #888;
            margin-top: 15px;
            text-align: center;
            font-style: italic;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
            color: #777;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ç§å­èŒå‘è¿‡ç¨‹å…¨æ—¶ç¨‹äº¤äº’æ•™å­¦åŠ¨ç”»</h1>
        <p class="subtitle">æ¨¡æ‹Ÿ0-15å¤©çš„å®Œæ•´èŒå‘è¿‡ç¨‹ï¼Œæ¢ç´¢ç§å­èŒå‘çš„æ¡ä»¶ä¸å†…éƒ¨å˜åŒ–</p>
    </header>

    <div class="container">
        <div class="main-content">
            <section class="animation-section">
                <h2 class="section-title">ç§å­èŒå‘è¿‡ç¨‹</h2>
                
                <div class="view-toggle">
                    <button id="soilViewBtn" class="view-btn active">åœŸå£¤å‰–é¢è§†å›¾</button>
                    <button id="seedViewBtn" class="view-btn">ç§å­ç‰¹å†™è§†å›¾</button>
                </div>
                
                <canvas id="animationCanvas" width="800" height="400"></canvas>
                
                <div class="timeline-container">
                    <div class="timeline-header">
                        <span>èŒå‘æ—¶é—´çº¿</span>
                        <span id="currentDay">ç¬¬ 0 å¤©</span>
                    </div>
                    <input type="range" id="timelineSlider" min="0" max="15" value="0" step="0.1">
                    
                    <div class="timeline-marks">
                        <div class="timeline-mark">0å¤©</div>
                        <div class="timeline-mark highlight">1å¤©</div>
                        <div class="timeline-mark">3å¤©</div>
                        <div class="timeline-mark highlight">5å¤©</div>
                        <div class="timeline-mark">10å¤©</div>
                        <div class="timeline-mark highlight">15å¤©</div>
                    </div>
                </div>
                
                <div class="playback-controls">
                    <button id="playPauseBtn" class="playback-btn">â–¶ æ’­æ”¾</button>
                    <button id="resetBtn" class="playback-btn">â†º é‡ç½®</button>
                    <button id="speedBtn" class="playback-btn">é€Ÿåº¦: 1x</button>
                </div>
                
                <p class="hint">æç¤ºï¼šå°†é¼ æ ‡æ‚¬åœåœ¨ç§å­å„éƒ¨åˆ†ä¸ŠæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼›æ‹–åŠ¨æ—¶é—´è½´æˆ–ä½¿ç”¨æ’­æ”¾æ§åˆ¶è§‚å¯Ÿä¸åŒé˜¶æ®µçš„å˜åŒ–ã€‚</p>
            </section>
            
            <section class="control-section">
                <h2 class="section-title">èŒå‘æ¡ä»¶æ§åˆ¶</h2>
                
                <div class="condition-controls">
                    <div class="condition-item water">
                        <div class="condition-icon">ğŸ’§</div>
                        <div class="condition-info">
                            <div class="condition-name">æ°´åˆ†</div>
                            <div class="condition-desc">ç§å­å¸æ°´è†¨èƒ€ï¼Œè½¯åŒ–ç§çš®ï¼Œå¯åŠ¨é…¶æ´»æ€§</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="waterToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="condition-item air">
                        <div class="condition-icon">ğŸ’¨</div>
                        <div class="condition-info">
                            <div class="condition-name">ç©ºæ°”ï¼ˆæ°§æ°”ï¼‰</div>
                            <div class="condition-desc">æä¾›å‘¼å¸ä½œç”¨æ‰€éœ€çš„æ°§æ°”ï¼Œé‡Šæ”¾èƒ½é‡</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="airToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="condition-item temp">
                        <div class="condition-icon">ğŸŒ¡ï¸</div>
                        <div class="condition-info">
                            <div class="condition-name">é€‚å®œæ¸©åº¦</div>
                            <div class="condition-desc">ç»´æŒé…¶çš„æœ€ä½³æ´»æ€§ï¼Œä¿ƒè¿›ä»£è°¢è¿‡ç¨‹</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="tempToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <h2 class="section-title">ä¿¡æ¯æç¤º</h2>
                <div class="info-panel">
                    <div class="info-title" id="infoTitle">æ¬¢è¿æ¢ç´¢ç§å­èŒå‘è¿‡ç¨‹ï¼</div>
                    <div id="infoText">è¯·å°†é¼ æ ‡æ‚¬åœåœ¨åŠ¨ç”»ä¸­çš„ç§å­ã€æ ¹ã€èŠ½ç­‰éƒ¨ä½ï¼Œæˆ–è°ƒæ•´æ—¶é—´è½´å’ŒèŒå‘æ¡ä»¶ï¼ŒæŸ¥çœ‹ç›¸åº”çš„è§£é‡Šä¿¡æ¯ã€‚</div>
                </div>
                
                <div class="hint">å®éªŒï¼šå°è¯•å…³é—­æŸä¸ªèŒå‘æ¡ä»¶ï¼ˆå¦‚æ°´ï¼‰ï¼Œè§‚å¯Ÿç§å­èŒå‘è¿‡ç¨‹å¦‚ä½•å—åˆ°å½±å“ã€‚</div>
            </section>
        </div>
    </div>
    
    <footer>
        <p>ç§å­èŒå‘æ•™å­¦åŠ¨ç”» | è®¾è®¡ï¼šç†ŠçŒ«è€å¸ˆ | æœ¬åŠ¨ç”»æ¨¡æ‹Ÿèœè±†ç§å­çš„èŒå‘è¿‡ç¨‹ï¼ˆå­å¶å‡ºåœŸå‹ï¼‰</p>
    </footer>

    <script>
        // è·å–DOMå…ƒç´ 
        const canvas = document.getElementById('animationCanvas');
        const ctx = canvas.getContext('2d');
        const timelineSlider = document.getElementById('timelineSlider');
        const currentDayEl = document.getElementById('currentDay');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const speedBtn = document.getElementById('speedBtn');
        const soilViewBtn = document.getElementById('soilViewBtn');
        const seedViewBtn = document.getElementById('seedViewBtn');
        const waterToggle = document.getElementById('waterToggle');
        const airToggle = document.getElementById('airToggle');
        const tempToggle = document.getElementById('tempToggle');
        const infoTitle = document.getElementById('infoTitle');
        const infoText = document.getElementById('infoText');

        // åŠ¨ç”»çŠ¶æ€å˜é‡
        let currentDay = 0;
        let isPlaying = false;
        let animationSpeed = 1; // 1x, 2x, 0.5x
        let currentView = 'soil'; // 'soil' æˆ– 'seed'
        let hoveredPart = null;
        let lastTimestamp = 0;
        
        // èŒå‘æ¡ä»¶
        const conditions = {
            water: true,
            air: true,
            temp: true
        };
        
        // ç§å­æ•°æ®
        const seeds = [
            { x: 150, y: 250, size: 1, stage: 0, rootLength: 0, shootLength: 0 },
            { x: 400, y: 230, size: 1, stage: 0, rootLength: 0, shootLength: 0 },
            { x: 650, y: 260, size: 1, stage: 0, rootLength: 0, shootLength: 0 }
        ];
        
        // é¢œè‰²å®šä¹‰
        const colors = {
            soilDark: '#8B4513',
            soilLight: '#D2B48C',
            seedDry: '#A0522D',
            seedHydrated: '#F5DEB3',
            root: '#90EE90',
            shoot: '#32CD32',
            leaf: '#228B22',
            water: 'rgba(135, 206, 235, 0.6)',
            airBubble: 'rgba(211, 211, 211, 0.7)',
            highlight: '#FF8C00',
            infoHighlight: '#1E90FF'
        };
        
        // ä¿¡æ¯æç¤ºæ•°æ®
        const partInfo = {
            seed: {
                title: "ç§å­",
                text: "ç§å­æ˜¯æ¤ç‰©çš„ç¹æ®–å™¨å®˜ï¼ŒåŒ…å«èƒšå’Œè¥å…»ç‰©è´¨ã€‚èŒå‘éœ€è¦æ°´åˆ†ã€æ°§æ°”å’Œé€‚å®œæ¸©åº¦ã€‚"
            },
            seedCoat: {
                title: "ç§çš®",
                text: "ä¿æŠ¤ç§å­å†…éƒ¨ç»“æ„ã€‚å¸æ°´åè½¯åŒ–ã€ç ´è£‚ï¼Œå…è®¸èƒšæ ¹ä¼¸å‡ºã€‚"
            },
            embryo: {
                title: "èƒš",
                text: "æœªæ¥æ¤ç‰©çš„é›å½¢ï¼ŒåŒ…æ‹¬èƒšæ ¹ã€èƒšè½´å’ŒèƒšèŠ½ï¼ˆå­å¶ï¼‰ã€‚"
            },
            radicle: {
                title: "èƒšæ ¹",
                text: "é¦–å…ˆçªç ´ç§çš®ï¼Œå‘ä¸‹ç”Ÿé•¿å½¢æˆä¸»æ ¹ï¼Œå¸æ”¶æ°´åˆ†å’Œæ— æœºç›ã€‚"
            },
            hypocotyl: {
                title: "èƒšè½´",
                text: "è¿æ¥èƒšæ ¹å’Œå­å¶çš„éƒ¨åˆ†ï¼Œä¼¸é•¿å°†å­å¶æ¨å‡ºåœŸå£¤ï¼ˆå­å¶å‡ºåœŸå‹ï¼‰ã€‚"
            },
            cotyledon: {
                title: "å­å¶",
                text: "å‚¨å­˜æˆ–è½¬è¿è¥å…»ç‰©è´¨ï¼Œä¸ºå¹¼è‹—æ—©æœŸç”Ÿé•¿æä¾›èƒ½é‡ã€‚"
            },
            trueLeaf: {
                title: "çœŸå¶",
                text: "åœ¨å­å¶ä¹‹åå±•å¼€ï¼Œèƒ½è¿›è¡Œå…‰åˆä½œç”¨ï¼Œä¸ºæ¤ç‰©åˆ¶é€ æœ‰æœºç‰©ã€‚"
            },
            rootHair: {
                title: "æ ¹æ¯›",
                text: "å¢åŠ æ ¹çš„è¡¨é¢ç§¯ï¼Œå¤§å¤§æé«˜æ°´åˆ†å’Œå…»åˆ†çš„å¸æ”¶æ•ˆç‡ã€‚"
            }
        };
        
        // æ—¶é—´çº¿å…³é”®äº‹ä»¶
        const timelineEvents = [
            { day: 0, title: "å¹²ç‡¥ç§å­", text: "ç§å­å¤„äºä¼‘çœ çŠ¶æ€ï¼Œä»£è°¢æ´»åŠ¨æä½ã€‚" },
            { day: 1, title: "å¸æ°´è†¨èƒ€", text: "ç§å­å¸æ”¶æ°´åˆ†ï¼Œä½“ç§¯å¢å¤§ï¼Œç§çš®è½¯åŒ–ã€‚" },
            { day: 2, title: "å¯åŠ¨ä»£è°¢", text: "é…¶æ´»æ€§æ¢å¤ï¼Œå‘¼å¸ä½œç”¨å¢å¼ºï¼Œè´®è—ç‰©è´¨å¼€å§‹åˆ†è§£ã€‚" },
            { day: 3, title: "èƒšæ ¹çªç ´", text: "èƒšæ ¹é¦–å…ˆçªç ´ç§çš®ï¼Œå¼€å§‹å‘ä¸‹ç”Ÿé•¿ã€‚" },
            { day: 5, title: "èƒšè½´ä¼¸é•¿", text: "èƒšè½´å¼€å§‹ä¼¸é•¿ï¼Œå°†å­å¶å‘ä¸Šæ¨åŠ¨ã€‚" },
            { day: 7, title: "å­å¶å‡ºåœŸ", text: "å­å¶éœ²å‡ºåœŸé¢ï¼Œå±•å¼€å˜ç»¿ï¼Œå¼€å§‹å…‰åˆä½œç”¨ã€‚" },
            { day: 10, title: "çœŸå¶å±•å¼€", text: "ç¬¬ä¸€å¯¹çœŸå¶å±•å¼€ï¼Œå¹¼è‹—è¿›å…¥è‡ªå…»ç”Ÿé•¿é˜¶æ®µã€‚" },
            { day: 15, title: "å¹¼è‹—å»ºç«‹", text: "æ ¹ç³»æ‰©å±•ï¼ŒçœŸå¶é•¿å¤§ï¼Œå¹¼è‹—ç‹¬ç«‹è¿›è¡Œå…‰åˆä½œç”¨ã€‚" }
        ];
        
        // åˆå§‹åŒ–
        function init() {
            updateCanvasSize();
            draw();
            
            // äº‹ä»¶ç›‘å¬
            timelineSlider.addEventListener('input', handleTimelineChange);
            playPauseBtn.addEventListener('click', togglePlayPause);
            resetBtn.addEventListener('click', resetAnimation);
            speedBtn.addEventListener('click', toggleSpeed);
            soilViewBtn.addEventListener('click', () => switchView('soil'));
            seedViewBtn.addEventListener('click', () => switchView('seed'));
            
            waterToggle.addEventListener('change', () => {
                conditions.water = waterToggle.checked;
                updateInfoFromConditions();
            });
            
            airToggle.addEventListener('change', () => {
                conditions.air = airToggle.checked;
                updateInfoFromConditions();
            });
            
            tempToggle.addEventListener('change', () => {
                conditions.temp = tempToggle.checked;
                updateInfoFromConditions();
            });
            
            canvas.addEventListener('mousemove', handleCanvasHover);
            canvas.addEventListener('mouseleave', () => {
                hoveredPart = null;
                draw();
            });
            
            // çª—å£å¤§å°è°ƒæ•´
            window.addEventListener('resize', updateCanvasSize);
            
            // å¯åŠ¨åŠ¨ç”»å¾ªç¯
            requestAnimationFrame(animate);
        }
        
        // æ›´æ–°ç”»å¸ƒå°ºå¯¸
        function updateCanvasSize() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth;
            canvas.height = 400;
            draw();
        }
        
        // å¤„ç†æ—¶é—´è½´å˜åŒ–
        function handleTimelineChange() {
            currentDay = parseFloat(timelineSlider.value);
            currentDayEl.textContent = `ç¬¬ ${currentDay.toFixed(1)} å¤©`;
            updateInfoFromTimeline();
            draw();
        }
        
        // åˆ‡æ¢æ’­æ”¾/æš‚åœ
        function togglePlayPause() {
            isPlaying = !isPlaying;
            playPauseBtn.textContent = isPlaying ? 'â¸ æš‚åœ' : 'â–¶ æ’­æ”¾';
            lastTimestamp = performance.now();
        }
        
        // é‡ç½®åŠ¨ç”»
        function resetAnimation() {
            currentDay = 0;
            timelineSlider.value = 0;
            currentDayEl.textContent = 'ç¬¬ 0 å¤©';
            isPlaying = false;
            playPauseBtn.textContent = 'â–¶ æ’­æ”¾';
            updateInfoFromTimeline();
            draw();
        }
        
        // åˆ‡æ¢æ’­æ”¾é€Ÿåº¦
        function toggleSpeed() {
            if (animationSpeed === 1) {
                animationSpeed = 2;
                speedBtn.textContent = 'é€Ÿåº¦: 2x';
            } else if (animationSpeed === 2) {
                animationSpeed = 0.5;
                speedBtn.textContent = 'é€Ÿåº¦: 0.5x';
            } else {
                animationSpeed = 1;
                speedBtn.textContent = 'é€Ÿåº¦: 1x';
            }
        }
        
        // åˆ‡æ¢è§†å›¾
        function switchView(view) {
            currentView = view;
            soilViewBtn.classList.toggle('active', view === 'soil');
            seedViewBtn.classList.toggle('active', view === 'seed');
            
            if (view === 'soil') {
                infoTitle.textContent = "åœŸå£¤å‰–é¢è§†å›¾";
                infoText.textContent = "è§‚å¯Ÿå¤šé¢—ç§å­åœ¨åœŸå£¤ä¸­çš„èŒå‘æƒ…å†µã€‚æ¯é¢—ç§å­çš„èŒå‘é€Ÿåº¦å¯èƒ½ç•¥æœ‰å·®å¼‚ï¼Œè¿™æ˜¯è‡ªç„¶ç°è±¡ã€‚";
            } else {
                infoTitle.textContent = "ç§å­ç‰¹å†™è§†å›¾";
                infoText.textContent = "èšç„¦è§‚å¯Ÿå•é¢—ç§å­çš„è¯¦ç»†èŒå‘è¿‡ç¨‹ã€‚å°†é¼ æ ‡æ‚¬åœåœ¨ç§å­å„éƒ¨åˆ†æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ã€‚";
            }
            
            draw();
        }
        
        // å¤„ç†ç”»å¸ƒæ‚¬åœ
        function handleCanvasHover(event) {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            hoveredPart = null;
            
            if (currentView === 'soil') {
                // æ£€æŸ¥æ˜¯å¦æ‚¬åœåœ¨ç§å­ä¸Š
                for (let i = 0; i < seeds.length; i++) {
                    const seed = seeds[i];
                    const seedSize = getSeedSize(seed);
                    const seedX = seed.x * (canvas.width / 800);
                    const seedY = seed.y;
                    
                    if (Math.abs(x - seedX) < seedSize * 15 && Math.abs(y - seedY) < seedSize * 15) {
                        hoveredPart = 'seed';
                        updateInfoFromPart('seed');
                        break;
                    }
                }
            } else {
                // ç§å­ç‰¹å†™è§†å›¾çš„æ‚¬åœæ£€æµ‹
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                
                // æ ¹æ®å½“å‰å¤©æ•°ç¡®å®šæ˜¾ç¤ºå“ªäº›éƒ¨åˆ†
                if (currentDay >= 1) {
                    // æ£€æŸ¥æ˜¯å¦æ‚¬åœåœ¨èƒšæ ¹ä¸Š
                    const rootLength = Math.min(currentDay * 8, 80);
                    if (x > centerX - 10 && x < centerX + 10 && y > centerY && y < centerY + rootLength) {
                        hoveredPart = 'radicle';
                        updateInfoFromPart('radicle');
                    }
                }
                
                if (currentDay >= 3 && !hoveredPart) {
                    // æ£€æŸ¥æ˜¯å¦æ‚¬åœåœ¨èƒšè½´/å­å¶ä¸Š
                    const shootLength = Math.max(0, (currentDay - 3) * 6);
                    if (x > centerX - 20 && x < centerX + 20 && y > centerY - shootLength && y < centerY) {
                        if (currentDay >= 7) {
                            hoveredPart = 'cotyledon';
                            updateInfoFromPart('cotyledon');
                        } else {
                            hoveredPart = 'hypocotyl';
                            updateInfoFromPart('hypocotyl');
                        }
                    }
                }
                
                if (!hoveredPart && x > centerX - 25 && x < centerX + 25 && y > centerY - 30 && y < centerY + 30) {
                    hoveredPart = 'seed';
                    updateInfoFromPart('seed');
                }
            }
            
            draw();
        }
        
        // æ ¹æ®æ—¶é—´çº¿æ›´æ–°ä¿¡æ¯
        function updateInfoFromTimeline() {
            let event = timelineEvents[0];
            for (let i = timelineEvents.length - 1; i >= 0; i--) {
                if (currentDay >= timelineEvents[i].day) {
                    event = timelineEvents[i];
                    break;
                }
            }
            
            infoTitle.textContent = `ç¬¬ ${currentDay.toFixed(1)} å¤©: ${event.title}`;
            infoText.textContent = event.text;
            
            // æ·»åŠ æ¡ä»¶å½±å“ä¿¡æ¯
            if (!conditions.water || !conditions.air || !conditions.temp) {
                infoText.textContent += " ç”±äºèŒå‘æ¡ä»¶ä¸æ»¡è¶³ï¼ŒèŒå‘è¿‡ç¨‹å—é˜»ã€‚";
            }
        }
        
        // æ ¹æ®éƒ¨ä½æ›´æ–°ä¿¡æ¯
        function updateInfoFromPart(part) {
            if (partInfo[part]) {
                infoTitle.textContent = partInfo[part].title;
                infoText.textContent = partInfo[part].text;
            }
        }
        
        // æ ¹æ®æ¡ä»¶æ›´æ–°ä¿¡æ¯
        function updateInfoFromConditions() {
            const missingConditions = [];
            if (!conditions.water) missingConditions.push("æ°´åˆ†");
            if (!conditions.air) missingConditions.push("ç©ºæ°”(æ°§æ°”)");
            if (!conditions.temp) missingConditions.push("é€‚å®œæ¸©åº¦");
            
            if (missingConditions.length > 0) {
                infoTitle.textContent = "èŒå‘æ¡ä»¶å®éªŒ";
                infoText.textContent = `å½“å‰ç¼ºå°‘: ${missingConditions.join("ã€")}ã€‚ç§å­èŒå‘è¿‡ç¨‹å°†å—åˆ°å½±å“ã€‚`;
            } else {
                updateInfoFromTimeline();
            }
        }
        
        // è·å–ç§å­å¤§å°ï¼ˆåŸºäºå½“å‰å¤©æ•°å’Œæ¡ä»¶ï¼‰
        function getSeedSize(seed) {
            let size = seed.size;
            
            // å¦‚æœæœ‰æ°´ï¼Œç§å­ä¼šå¸æ°´è†¨èƒ€
            if (conditions.water && currentDay > 0) {
                size = 1 + Math.min(currentDay / 5, 0.5); // æœ€å¤§è†¨èƒ€50%
            }
            
            return size;
        }
        
        // ç»˜åˆ¶åœŸå£¤å‰–é¢è§†å›¾
        function drawSoilView() {
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶åœŸå£¤èƒŒæ™¯
            ctx.fillStyle = colors.soilLight;
            ctx.fillRect(0, height * 0.6, width, height * 0.4);
            
            // ç»˜åˆ¶åœŸå£¤çº¹ç†
            ctx.fillStyle = colors.soilDark;
            for (let i = 0; i < 50; i++) {
                const x = Math.random() * width;
                const y = height * 0.6 + Math.random() * height * 0.4;
                const size = Math.random() * 3 + 1;
                ctx.fillRect(x, y, size, size);
            }
            
            // ç»˜åˆ¶åœŸå£¤è¡¨å±‚
            ctx.fillStyle = colors.soilDark;
            ctx.fillRect(0, height * 0.6, width, 10);
            
            // ç»˜åˆ¶æ¯é¢—ç§å­
            seeds.forEach((seed, index) => {
                const seedSize = getSeedSize(seed);
                const seedX = seed.x * (width / 800);
                const seedY = seed.y;
                
                // è®¡ç®—èŒå‘è¿›åº¦ï¼ˆæ¯é¢—ç§å­ç•¥æœ‰å·®å¼‚ï¼‰
                let seedProgress = Math.max(0, currentDay - index * 0.3);
                if (!conditions.water || !conditions.air || !conditions.temp) {
                    seedProgress = Math.min(seedProgress, 1); // æ¡ä»¶ä¸è¶³æ—¶é™åˆ¶ç”Ÿé•¿
                }
                
                // ç»˜åˆ¶ç§å­
                ctx.fillStyle = conditions.water && seedProgress > 0 ? colors.seedHydrated : colors.seedDry;
                ctx.beginPath();
                ctx.ellipse(seedX, seedY, 15 * seedSize, 10 * seedSize, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // ç»˜åˆ¶ç§çš®è£‚çº¹ï¼ˆç¬¬1å¤©åï¼‰
                if (seedProgress > 1 && conditions.water) {
                    ctx.strokeStyle = colors.soilDark;
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(seedX - 8 * seedSize, seedY - 3);
                    ctx.lineTo(seedX + 5 * seedSize, seedY + 4);
                    ctx.stroke();
                }
                
                // ç»˜åˆ¶èƒšæ ¹ï¼ˆç¬¬2å¤©åï¼‰
                if (seedProgress > 2 && conditions.water && conditions.air && conditions.temp) {
                    const rootLength = Math.min((seedProgress - 2) * 25, 60);
                    ctx.fillStyle = colors.root;
                    ctx.beginPath();
                    ctx.moveTo(seedX, seedY + 10 * seedSize);
                    ctx.lineTo(seedX - 5, seedY + 10 * seedSize + rootLength);
                    ctx.lineTo(seedX + 5, seedY + 10 * seedSize + rootLength);
                    ctx.closePath();
                    ctx.fill();
                    
                    // æ ¹å°–
                    ctx.fillStyle = colors.highlight;
                    ctx.beginPath();
                    ctx.arc(seedX, seedY + 10 * seedSize + rootLength, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // ç»˜åˆ¶èƒšè½´å’Œå­å¶ï¼ˆç¬¬4å¤©åï¼‰
                if (seedProgress > 4 && conditions.water && conditions.air && conditions.temp) {
                    const shootLength = Math.min((seedProgress - 4) * 15, 40);
                    ctx.fillStyle = colors.shoot;
                    ctx.fillRect(seedX - 3, seedY - shootLength, 6, shootLength);
                    
                    // å­å¶ï¼ˆç¬¬6å¤©åï¼‰
                    if (seedProgress > 6) {
                        ctx.fillStyle = colors.leaf;
                        // å·¦å­å¶
                        ctx.beginPath();
                        ctx.ellipse(seedX - 10, seedY - shootLength, 8, 5, 0, 0, Math.PI * 2);
                        ctx.fill();
                        // å³å­å¶
                        ctx.beginPath();
                        ctx.ellipse(seedX + 10, seedY - shootLength, 8, 5, 0, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                // ç»˜åˆ¶æ‚¬åœé«˜äº®
                if (hoveredPart === 'seed') {
                    ctx.strokeStyle = colors.infoHighlight;
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.ellipse(seedX, seedY, 18 * seedSize, 13 * seedSize, 0, 0, Math.PI * 2);
                    ctx.stroke();
                }
            });
            
            // ç»˜åˆ¶æ¡ä»¶æ•ˆæœ
            if (conditions.water && currentDay > 0) {
                // ç»˜åˆ¶æ°´æ¸—é€æ•ˆæœ
                ctx.fillStyle = colors.water;
                for (let i = 0; i < 3; i++) {
                    const x = 100 + i * 300;
                    const radius = Math.min(currentDay * 3, 50);
                    ctx.beginPath();
                    ctx.arc(x * (width / 800), height * 0.7, radius, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            if (conditions.air && currentDay > 0) {
                // ç»˜åˆ¶æ°”æ³¡ï¼ˆè¡¨ç¤ºæ°§æ°”ï¼‰
                ctx.fillStyle = colors.airBubble;
                for (let i = 0; i < 10; i++) {
                    const x = 50 + Math.random() * (width - 100);
                    const y = height * 0.65 + Math.random() * height * 0.35;
                    const size = Math.random() * 4 + 2;
                    const offset = (currentDay * 5 + i * 10) % 100;
                    ctx.beginPath();
                    ctx.arc(x, y - offset, size, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // ç»˜åˆ¶æ ‡é¢˜
            ctx.fillStyle = colors.soilDark;
            ctx.font = "16px Arial";
            ctx.fillText("åœŸå£¤å‰–é¢è§†å›¾ - è§‚å¯Ÿå¤šé¢—ç§å­çš„èŒå‘", 20, 30);
            
            // ç»˜åˆ¶å›¾ä¾‹
            drawLegend();
        }
        
        // ç»˜åˆ¶ç§å­ç‰¹å†™è§†å›¾
        function drawSeedView() {
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶èƒŒæ™¯
            ctx.fillStyle = '#f0f8ff';
            ctx.fillRect(0, 0, width, height);
            
            // æ ¹æ®æ¡ä»¶è°ƒæ•´å½“å‰è¿›åº¦
            let effectiveDay = currentDay;
            if (!conditions.water || !conditions.air || !conditions.temp) {
                effectiveDay = Math.min(effectiveDay, 1); // æ¡ä»¶ä¸è¶³æ—¶åœæ­¢åœ¨æ—©æœŸé˜¶æ®µ
            }
            
            // ç»˜åˆ¶ç§å­
            const seedSize = 1 + Math.min(effectiveDay / 5, 0.5);
            ctx.fillStyle = conditions.water && effectiveDay > 0 ? colors.seedHydrated : colors.seedDry;
            ctx.beginPath();
            ctx.ellipse(centerX, centerY, 30 * seedSize, 20 * seedSize, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // ç»˜åˆ¶ç§çš®è£‚çº¹ï¼ˆç¬¬1å¤©åï¼‰
            if (effectiveDay > 1 && conditions.water) {
                ctx.strokeStyle = colors.soilDark;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(centerX - 15 * seedSize, centerY - 8);
                ctx.lineTo(centerX + 10 * seedSize, centerY + 10);
                ctx.stroke();
            }
            
            // ç»˜åˆ¶èƒšï¼ˆå§‹ç»ˆå­˜åœ¨ï¼Œä½†é¢œè‰²å˜åŒ–ï¼‰
            ctx.fillStyle = effectiveDay > 0 ? colors.root : '#888';
            ctx.beginPath();
            ctx.ellipse(centerX, centerY, 15 * seedSize, 10 * seedSize, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // ç»˜åˆ¶èƒšæ ¹ï¼ˆç¬¬2å¤©åï¼‰
            if (effectiveDay > 2 && conditions.water && conditions.air && conditions.temp) {
                const rootLength = Math.min((effectiveDay - 2) * 10, 80);
                ctx.fillStyle = colors.root;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY + 20 * seedSize);
                ctx.lineTo(centerX - 8, centerY + 20 * seedSize + rootLength);
                ctx.lineTo(centerX + 8, centerY + 20 * seedSize + rootLength);
                ctx.closePath();
                ctx.fill();
                
                // æ ¹å°–å’Œæ ¹æ¯›
                ctx.fillStyle = colors.highlight;
                ctx.beginPath();
                ctx.arc(centerX, centerY + 20 * seedSize + rootLength, 5, 0, Math.PI * 2);
                ctx.fill();
                
                // æ ¹æ¯›
                if (effectiveDay > 4) {
                    ctx.strokeStyle = colors.root;
                    ctx.lineWidth = 1;
                    for (let i = 0; i < 8; i++) {
                        const yPos = centerY + 20 * seedSize + 20 + i * 8;
                        ctx.beginPath();
                        ctx.moveTo(centerX - 8, yPos);
                        ctx.lineTo(centerX - 15, yPos);
                        ctx.stroke();
                        ctx.beginPath();
                        ctx.moveTo(centerX + 8, yPos);
                        ctx.lineTo(centerX + 15, yPos);
                        ctx.stroke();
                    }
                }
            }
            
            // ç»˜åˆ¶èƒšè½´å’Œå­å¶ï¼ˆç¬¬4å¤©åï¼‰
            if (effectiveDay > 4 && conditions.water && conditions.air && conditions.temp) {
                const shootLength = Math.min((effectiveDay - 4) * 8, 50);
                ctx.fillStyle = colors.shoot;
                ctx.fillRect(centerX - 5, centerY - shootLength, 10, shootLength);
                
                // å­å¶ï¼ˆç¬¬6å¤©åï¼‰
                if (effectiveDay > 6) {
                    ctx.fillStyle = colors.leaf;
                    // å·¦å­
<!--æ£€æµ‹åˆ°ä»£ç æˆªæ–­ï¼Œè‡ªåŠ¨ç»­å†™ä¸­...-->
å¶
                    ctx.beginPath();
                    ctx.ellipse(centerX - 15, centerY - shootLength, 12, 8, -0.3, 0, Math.PI * 2);
                    ctx.fill();
                    // å³å­å¶
                    ctx.beginPath();
                    ctx.ellipse(centerX + 15, centerY - shootLength, 12, 8, 0.3, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // çœŸå¶ï¼ˆç¬¬10å¤©åï¼‰
                    if (effectiveDay > 10) {
                        ctx.fillStyle = colors.leaf;
                        // å·¦çœŸå¶
                        ctx.beginPath();
                        ctx.moveTo(centerX - 5, centerY - shootLength - 5);
                        ctx.lineTo(centerX - 20, centerY - shootLength - 25);
                        ctx.lineTo(centerX - 5, centerY - shootLength - 20);
                        ctx.closePath();
                        ctx.fill();
                        // å³çœŸå¶
                        ctx.beginPath();
                        ctx.moveTo(centerX + 5, centerY - shootLength - 5);
                        ctx.lineTo(centerX + 20, centerY - shootLength - 25);
                        ctx.lineTo(centerX + 5, centerY - shootLength - 20);
                        ctx.closePath();
                        ctx.fill();
                    }
                }
            }
            
            // ç»˜åˆ¶å†…éƒ¨ç‰©è´¨è½¬è¿ç¤ºæ„ï¼ˆç¬¬1-5å¤©ï¼‰
            if (effectiveDay > 1 && effectiveDay < 6 && conditions.water && conditions.air && conditions.temp) {
                ctx.strokeStyle = colors.highlight;
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 3]);
                
                // ä»å­å¶åˆ°èƒšæ ¹çš„ç®­å¤´
                ctx.beginPath();
                ctx.moveTo(centerX - 10, centerY - 5);
                ctx.lineTo(centerX - 5, centerY + 10);
                ctx.lineTo(centerX, centerY + 25);
                ctx.stroke();
                
                // ç®­å¤´å¤´
                ctx.fillStyle = colors.highlight;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY + 25);
                ctx.lineTo(centerX - 3, centerY + 20);
                ctx.lineTo(centerX + 3, centerY + 20);
                ctx.closePath();
                ctx.fill();
                
                ctx.setLineDash([]);
            }
            
            // ç»˜åˆ¶å‘¼å¸ä½œç”¨æ°”æ³¡ï¼ˆç¬¬1å¤©åï¼Œæœ‰ç©ºæ°”æ—¶ï¼‰
            if (effectiveDay > 1 && conditions.air) {
                ctx.fillStyle = colors.airBubble;
                for (let i = 0; i < 5; i++) {
                    const x = centerX - 20 + i * 10;
                    const y = centerY + 10 - (effectiveDay * 2 + i * 5) % 30;
                    const size = Math.random() * 3 + 2;
                    ctx.beginPath();
                    ctx.arc(x, y, size, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // ç»˜åˆ¶æ‚¬åœé«˜äº®
            if (hoveredPart) {
                ctx.strokeStyle = colors.infoHighlight;
                ctx.lineWidth = 3;
                
                if (hoveredPart === 'seed') {
                    ctx.beginPath();
                    ctx.ellipse(centerX, centerY, 35 * seedSize, 25 * seedSize, 0, 0, Math.PI * 2);
                    ctx.stroke();
                } else if (hoveredPart === 'radicle') {
                    const rootLength = Math.min((effectiveDay - 2) * 10, 80);
                    ctx.beginPath();
                    ctx.moveTo(centerX - 10, centerY + 20 * seedSize);
                    ctx.lineTo(centerX - 15, centerY + 20 * seedSize + rootLength);
                    ctx.lineTo(centerX + 15, centerY + 20 * seedSize + rootLength);
                    ctx.lineTo(centerX + 10, centerY + 20 * seedSize);
                    ctx.closePath();
                    ctx.stroke();
                } else if (hoveredPart === 'hypocotyl' || hoveredPart === 'cotyledon') {
                    const shootLength = Math.min((effectiveDay - 4) * 8, 50);
                    ctx.beginPath();
                    ctx.rect(centerX - 8, centerY - shootLength - 5, 16, shootLength + 10);
                    ctx.stroke();
                }
            }
            
            // ç»˜åˆ¶æ ‡é¢˜
            ctx.fillStyle = colors.soilDark;
            ctx.font = "16px Arial";
            ctx.fillText("ç§å­ç‰¹å†™è§†å›¾ - è§‚å¯Ÿå†…éƒ¨ç»“æ„ä¸å˜åŒ–", 20, 30);
            
            // ç»˜åˆ¶æ ‡æ³¨
            ctx.fillStyle = "#333";
            ctx.font = "12px Arial";
            
            if (effectiveDay > 0) {
                ctx.fillText("ç§çš®", centerX + 40 * seedSize, centerY);
            }
            
            if (effectiveDay > 2) {
                ctx.fillText("èƒšæ ¹", centerX, centerY + 20 * seedSize + 40);
            }
            
            if (effectiveDay > 4) {
                ctx.fillText("èƒšè½´", centerX + 25, centerY - 20);
            }
            
            if (effectiveDay > 6) {
                ctx.fillText("å­å¶", centerX - 40, centerY - 40);
            }
            
            // ç»˜åˆ¶å›¾ä¾‹
            drawLegend();
        }
        
        // ç»˜åˆ¶å›¾ä¾‹
        function drawLegend() {
            const width = canvas.width;
            
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.fillRect(width - 160, 50, 150, 120);
            
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            ctx.strokeRect(width - 160, 50, 150, 120);
            
            ctx.fillStyle = '#333';
            ctx.font = "bold 14px Arial";
            ctx.fillText("å›¾ä¾‹", width - 150, 70);
            
            ctx.font = "12px Arial";
            
            // æ°´åˆ†
            ctx.fillStyle = colors.water;
            ctx.fillRect(width - 150, 85, 12, 12);
            ctx.fillStyle = '#333';
            ctx.fillText("æ°´åˆ†", width - 130, 95);
            
            // ç©ºæ°”
            ctx.fillStyle = colors.airBubble;
            ctx.beginPath();
            ctx.arc(width - 150, 110, 6, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#333';
            ctx.fillText("ç©ºæ°”(æ°§æ°”)", width - 130, 115);
            
            // ç‰©è´¨è½¬è¿
            ctx.strokeStyle = colors.highlight;
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 3]);
            ctx.beginPath();
            ctx.moveTo(width - 155, 125);
            ctx.lineTo(width - 140, 125);
            ctx.stroke();
            ctx.setLineDash([]);
            ctx.fillStyle = '#333';
            ctx.fillText("ç‰©è´¨è½¬è¿", width - 130, 135);
            
            // ç”Ÿé•¿ç‚¹
            ctx.fillStyle = colors.highlight;
            ctx.beginPath();
            ctx.arc(width - 150, 150, 4, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#333';
            ctx.fillText("ç”Ÿé•¿ç‚¹", width - 130, 155);
        }
        
        // ç»˜åˆ¶å‡½æ•°
        function draw() {
            if (currentView === 'soil') {
                drawSoilView();
            } else {
                drawSeedView();
            }
        }
        
        // åŠ¨ç”»å¾ªç¯
        function animate(timestamp) {
            if (isPlaying) {
                if (lastTimestamp === 0) lastTimestamp = timestamp;
                const deltaTime = timestamp - lastTimestamp;
                
                // æ ¹æ®é€Ÿåº¦æ›´æ–°å¤©æ•°
                currentDay += deltaTime * 0.001 * animationSpeed;
                
                // é™åˆ¶å¤©æ•°èŒƒå›´
                if (currentDay > 15) {
                    currentDay = 15;
                    isPlaying = false;
                    playPauseBtn.textContent = 'â–¶ æ’­æ”¾';
                }
                
                // æ›´æ–°UI
                timelineSlider.value = currentDay;
                currentDayEl.textContent = `ç¬¬ ${currentDay.toFixed(1)} å¤©`;
                updateInfoFromTimeline();
                
                // é‡ç»˜
                draw();
                
                lastTimestamp = timestamp;
            } else {
                lastTimestamp = 0;
            }
            
            requestAnimationFrame(animate);
        }
        
        // å¯åŠ¨åº”ç”¨
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>